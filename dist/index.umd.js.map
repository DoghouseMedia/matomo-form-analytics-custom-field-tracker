{"version":3,"file":"index.umd.js","sources":["../src/FormAnalyticsCustomFieldTracker.js","../src/Enums/FieldCategories.js","../src/BaseField.js"],"sourcesContent":["/**\n * Field Classes Registry\n * Maps field types to their corresponding classes\n */\nconst fieldClasses = {};\nlet debugMode = false;\n\n/**\n * Factory function for creating fields of any type\n * Uses the factory pattern to create field instances based on type\n *\n * @param {Object} tracker - Matomo tracker instance\n * @param {HTMLElement} element - DOM element\n * @param {string} fieldName - Field identifier\n * @param {string} fieldType - Type of field to create\n * @returns {BaseField|null} Created field instance or null if type not found\n * @throws {Error} If field creation fails\n */\nfunction createField(tracker, element, fieldName, fieldType) {\n    const FieldClass = fieldClasses[fieldType];\n    if (!FieldClass) {\n        debugMode && console.error(`No field class found for type: ${fieldType}`);\n        return null;\n    }\n\n    try {\n        // Verify the fieldType matches the class's static property\n        if (FieldClass.fieldType !== fieldType) {\n            debugMode && console.error(`Field type mismatch: expected ${fieldType}, got ${FieldClass.fieldType}`);\n            return null;\n        }\n\n        const field = new FieldClass(tracker, element, fieldName);\n        field.setupEventListeners();\n        return field;\n    } catch (error) {\n        debugMode && console.error(`Error creating ${fieldType} field:`, error);\n        return null;\n    }\n}\n\nfunction injectCustomFields(tracker, form) {\n    // Dynamically get field types and their selectors from registered field classes\n    Object.entries(fieldClasses).forEach(([fieldType, FieldClass]) => {\n        // Check if the field class has a selector defined\n        if (FieldClass.selector) {\n            const fields = form.querySelectorAll(FieldClass.selector);\n            fields.forEach(field => {\n                if (tracker.fieldNodes.includes(field)) {\n                    if (debugMode) {\n                        console.log(`‚è≠Ô∏è Skipping already tracked ${fieldType} field: ${field.getAttribute('data-name')}`);\n                    }\n                    return;\n                }\n\n                const fieldName = field.getAttribute('data-name');\n                if (!fieldName) {\n                    debugMode && console.warn(`‚ö†Ô∏è Field missing data-name attribute:`, field);\n                    return;\n                }\n\n                const customField = createField(tracker, field, fieldName, fieldType);\n\n                if (customField) {\n                    // Add to tracker\n                    tracker.fields.push(customField);\n                    tracker.fieldNodes.push(field);\n\n                    debugMode && console.log(`‚úÖ Integrated custom ${fieldType} field: ${fieldName}`);\n                }\n            });\n        }\n    });\n}\n\n/**\n * Re-scans both native tracker and custom fields when new fields appear\n * Handles pagination and conditional fields\n */\nfunction reScanFormFields(tracker, form) {\n    if (!tracker || !form) return;\n\n    // Re-scan the native tracker for new standard fields\n    if (typeof tracker.scanForFields === 'function') {\n        tracker.scanForFields();\n        if (debugMode) {\n            console.log('üîÑ Re-scanned native tracker for new fields');\n        }\n    }\n\n    // Re-inject custom fields\n    injectCustomFields(tracker, form);\n}\n\n/**\n * Sets up MutationObserver to detect new fields appearing\n * Handles both pagination and conditional fields\n */\nfunction setupDynamicFieldObserver(tracker, form) {\n    let reScanTimeout = null;\n\n    const observer = new MutationObserver((mutations) => {\n        let hasNewFields = false;\n\n        mutations.forEach((mutation) => {\n            mutation.addedNodes.forEach((node) => {\n                if (node.nodeType === 1) { // Element node\n                    // Check if new form fields were added\n                    const isFormField = node.matches && (\n                        // Standard form fields\n                        node.matches('input, select, textarea') ||\n                        // Custom field containers\n                        node.matches('[class*=\"formulate-input-element\"]') ||\n                        // Fields within added nodes\n                        node.querySelector('input, select, textarea, [class*=\"formulate-input-element\"]')\n                    );\n\n                    if (isFormField) {\n                        hasNewFields = true;\n                    }\n                }\n            });\n        });\n\n        if (hasNewFields) {\n            // Debounce re-scanning to avoid multiple scans for rapid changes\n            if (reScanTimeout) {\n                clearTimeout(reScanTimeout);\n            }\n\n            reScanTimeout = setTimeout(() => {\n                if (debugMode) {\n                    console.log('üìÑ New fields detected (pagination/conditional), re-scanning...');\n                }\n                reScanFormFields(tracker, form);\n                reScanTimeout = null;\n            }, 300); // 300ms debounce\n        }\n    });\n\n    // Observe the form for changes\n    observer.observe(form, {\n        childList: true,    // Watch for added/removed children\n        subtree: true,      // Watch all descendants\n        attributes: false,\n    });\n\n    if (debugMode) {\n        console.log('üëÄ Set up dynamic field observer for pagination/conditional fields');\n    }\n\n    // Store observer reference for potential cleanup\n    form._fieldObserver = observer;\n}\n\nexport default {\n    init(customFields = [], debug = false) {\n        debugMode = debug;\n\n        // Register custom fields if provided\n        if (customFields && customFields.length > 0) {\n            customFields.forEach(({ fieldType, FieldClass }) => {\n                if (fieldType && FieldClass) {\n                    fieldClasses[fieldType] = FieldClass;\n                } else {\n                    debugMode && console.warn('Custom field must have fieldType and FieldClass properties');\n                }\n            });\n        }\n\n        // Wait for FormAnalytics to initialize\n        window.matomoFormAnalyticsAsyncInit = function () {\n            const forms = document.querySelectorAll('form, [data-matomo-form]');\n            forms.forEach(form => {\n                setTimeout(() => {\n                    const tracker = window.Piwik?.FormAnalytics?.element?.findFormTrackerInstance(form);\n                    if (tracker) {\n                        injectCustomFields(tracker, form);\n                        // Set up an observer for dynamic fields (pagination/conditional)\n                        setupDynamicFieldObserver(tracker, form);\n                    }\n                }, 100);\n            });\n        };\n    }\n};\n\n/**\n * Get available field types\n * @returns {string[]} Array of supported field types\n */\nexport const getAvailableFieldTypes = () => Object.keys(fieldClasses);\n\n/**\n * Check if a field type is supported\n * @param {string} fieldType - Field type to check\n * @returns {boolean} True if supported, false otherwise\n */\nexport const isFieldTypeSupported = (type) => type in fieldClasses;\n\n/**\n * Provides global access to the current debug mode state.\n * This allows other modules (e.g., BaseField) to check whether debug logging is enabled,\n * without needing to pass the debug flag through constructors or method parameters.\n */\nexport const getDebugMode = () => debugMode;\n","/**\n * Field Categories Enum\n *\n * Defines the three field categories supported by Matomo FormAnalytics\n * - FIELD_TEXT: Text-based input fields\n * - FIELD_SELECTABLE: Selection-based fields\n * - FIELD_CHECKABLE: Checkbox/radio fields\n *\n * @enum {string}\n */\nexport const FieldCategories = {\n    /**\n     * Text-based input fields (password, text, url, tel, email, search, textarea)\n     */\n    TEXT: 'FIELD_TEXT',\n    /**\n     * Selection-based fields (color, date, datetime, datetime-local, month, number, range, time, week, select)\n     */\n    SELECTABLE: 'FIELD_SELECTABLE',\n    /**\n     * Checkbox/radio fields (radio, checkbox)\n     */\n    CHECKABLE: 'FIELD_CHECKABLE'\n};\n\n/**\n * Validates if a field category is supported by Matomo\n * @param {string} category - Field category to validate\n * @returns {boolean} True if category is valid\n */\nexport function isValidFieldCategory(category) {\n    return Object.values(FieldCategories).includes(category);\n}\n\n/**\n * Gets all supported field categories\n * @returns {string[]} Array of all supported field categories\n */\nexport function getSupportedFieldCategories() {\n    return Object.values(FieldCategories);\n}\n\n/**\n * Gets field category description\n * @param {string} category - Field category\n * @returns {string} Human-readable description\n */\nexport function getFieldCategoryDescription(category) {\n    const descriptions = {\n        [FieldCategories.TEXT]: 'Text-based input fields (password, text, url, tel, email, search, textarea)',\n        [FieldCategories.SELECTABLE]: 'Selection-based fields (color, date, datetime, datetime-local, month, number, range, time, week, select)',\n        [FieldCategories.CHECKABLE]: 'Checkbox/radio fields (radio, checkbox)'\n    };\n\n    return descriptions[category] || 'Unknown field category';\n}\n","import { FieldCategories } from './Enums/FieldCategories.js';\nimport { getDebugMode } from './FormAnalyticsCustomFieldTracker.js';\n\n/**\n * BaseField Class\n *\n * A reusable abstract class providing shared tracking logic\n * for all custom form field types (e.g., WYSIWYG, rating, image selector).\n *\n * @class BaseField\n * @abstract\n */\nexport class BaseField {\n    /**\n     * Field Categories ENUM - Available to all subclasses\n     * @static\n     */\n    static FieldCategories = FieldCategories;\n\n    /**\n     * Creates a new BaseField instance\n     *\n     * @param {Object} tracker - Matomo tracker instance\n     * @param {HTMLElement} element - DOM element for the field\n     * @param {string} fieldName - Unique identifier for the field\n     */\n    constructor(tracker, element, fieldName) {\n        // Get fieldType and category from static properties\n        const fieldType = this.constructor.fieldType;\n        const category = this.constructor.category;\n        const selector = this.constructor.selector;\n\n        if (!fieldType || !category || !selector) {\n            throw new Error(`${this.constructor.name} must define static fieldType, selector and category properties`);\n        }\n\n        // Common properties for all field types\n        this.discoveredDate = Date.now();\n        this.timespent = 0;\n        this.hesitationtime = 0;\n        this.nodes = [element];\n        this.tagName = 'div';\n        this.fieldName = fieldName;\n        this.fieldType = fieldType;\n        this.startFocus = null;\n        this.timeLastChange = null;\n        this.numChanges = 0;\n        this.numFocus = 0;\n        this.numDeletes = 0;\n        this.numCursor = 0;\n        this.canCountChange = true;\n        this.isFocusedCausedAuto = false;\n        this.hasChangedValueSinceFocus = false;\n        this.tracker = tracker;\n        this.category = category;\n        this.firstInteractionTime = null;\n\n        // Store references for field-specific implementations\n        this.element = element;\n        this.debug = getDebugMode();\n\n        // Cleanup tracking\n        this._eventListeners = new Map();\n        this._timers = new Set();\n        this._mutationObservers = new Set();\n        this._isDestroyed = false;\n        this._delayedBlurTimer = null;\n    }\n\n    /**\n     * Helper method to track event listeners for cleanup\n     * @private\n     * @param {HTMLElement} element - Element to attach listener to\n     * @param {string} event - Event type\n     * @param {Function} handler - Event handler function\n     * @param {Object} options - Event listener options\n     */\n    _addTrackedEventListener(element, event, handler, options = {}) {\n        if (this._isDestroyed) return;\n\n        const key = `${element}_${event}`;\n        if (!this._eventListeners.has(key)) {\n            this._eventListeners.set(key, []);\n        }\n\n        element.addEventListener(event, handler, options);\n        this._eventListeners.get(key).push({ element, event, handler, options });\n    }\n\n    /**\n     * Helper method to track timers for cleanup\n     * @private\n     * @param {number} timerId - Timer ID from setTimeout/setInterval\n     * @returns {number} The timer ID\n     */\n    _trackTimer(timerId) {\n        if (this._isDestroyed) return timerId;\n        this._timers.add(timerId);\n        return timerId;\n    }\n\n    /**\n     * Helper method to track MutationObservers for cleanup\n     * @private\n     * @param {MutationObserver} observer - MutationObserver instance\n     * @returns {MutationObserver} The observer instance\n     */\n    _trackMutationObserver(observer) {\n        if (this._isDestroyed) return observer;\n        this._mutationObservers.add(observer);\n        return observer;\n    }\n\n    /**\n     * Tracks first interaction and sets focus if not already focused\n     * Useful for click-based fields (rating, image selector, etc.) that need to track\n     * time from the first interaction to blur for accurate \"time spent per question\" metrics\n     *\n     * @returns {boolean} True if this was the first interaction, false otherwise\n     */\n    trackFirstInteraction() {\n        if (!this.firstInteractionTime) {\n            this.firstInteractionTime = Date.now();\n            this.onFocus();\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Schedules a delayed blur event\n     * Useful for fields that need to complete a focus ‚Üí change ‚Üí blur cycle\n     */\n    scheduleDelayedBlur(delay = 100) {\n        this.cancelDelayedBlur();\n\n        this._delayedBlurTimer = this._trackTimer(setTimeout(() => {\n            if (this.hasChangedValueSinceFocus && this.startFocus) {\n                this.timeLastChange = Date.now();\n            }\n\n            this._delayedBlurTimer = null;\n            this.onBlur();\n        }, delay));\n\n        return this._delayedBlurTimer;\n    }\n\n    /**\n     * Cancels any scheduled delayed blur\n     */\n    cancelDelayedBlur() {\n        if (this._delayedBlurTimer) {\n            clearTimeout(this._delayedBlurTimer);\n            this._timers.delete(this._delayedBlurTimer);\n            this._delayedBlurTimer = null;\n        }\n    }\n\n    /**\n     * Abstract method: Gets the interactive element for this field\n     * Must be implemented by subclasses to define their interactive element\n     * @abstract\n     * @returns {HTMLElement|NodeList} Interactive element for this field\n     * @throws {Error} If not implemented by subclass\n     */\n    getInteractiveElement() {\n        throw new Error(`getInteractiveElement() must be implemented by ${this.fieldType} field`);\n    }\n\n    /**\n     * Abstract method: Determines if field is blank/empty\n     * Must be implemented by subclasses\n     * @abstract\n     * @returns {boolean} True if field is blank, false otherwise\n     * @throws {Error} If not implemented by subclass\n     */\n    isBlank() {\n        throw new Error(`isBlank() must be implemented by ${this.fieldType} field`);\n    }\n\n    /**\n     * Abstract method: Gets field size/content length\n     * Must be implemented by subclasses\n     * @abstract\n     * @returns {number} Field size (content length, rating value, etc.)\n     * @throws {Error} If not implemented by subclass\n     */\n    getFieldSize() {\n        throw new Error(`getFieldSize() must be implemented by ${this.fieldType} field`);\n    }\n\n    /**\n     * Sets up event listeners for all custom field types\n     * This method provides common event handling for all custom fields\n     * Can be overridden by subclasses for custom event handling\n     */\n    setupEventListeners() {\n        // Check if the subclass has overridden this method.\n        if (this.constructor.prototype.setupEventListeners !== BaseField.prototype.setupEventListeners) {\n            // Subclass has its own implementation, call it\n            this.constructor.prototype.setupEventListeners.call(this);\n            return;\n        }\n\n        // Default implementation for fields that don't override\n        this.setupDefaultEventListeners();\n    }\n\n    /**\n     * Sets up default event listeners for standard field types\n     * Used by fields that don't need custom event handling\n     */\n    setupDefaultEventListeners() {\n        // Get the actual interactive element (overridden by subclasses)\n        const interactiveElement = this.getInteractiveElement();\n\n        if (!interactiveElement) {\n            this.debug && console.error(`${this.fieldType.toUpperCase()} interactive element not found:`, this.element);\n            return;\n        }\n\n        // Focus event\n        this._addTrackedEventListener(interactiveElement, 'focus', () => {\n            this.onFocus();\n        });\n\n        // Blur event\n        this._addTrackedEventListener(interactiveElement, 'blur', () => {\n            this.onBlur();\n        });\n\n        // Input event (typing)\n        this._addTrackedEventListener(interactiveElement, 'input', () => {\n            this.onChange();\n        });\n\n        // Keydown event (cursor movements, deletions)\n        this._addTrackedEventListener(interactiveElement, 'keydown', (event) => {\n            this.handleKeydown(event);\n        });\n\n        // Click event (cursor movements)\n        this._addTrackedEventListener(interactiveElement, 'click', () => {\n            this.trackCursorMovement();\n            this.debug && console.log(`‚ö°Ô∏è ${this.fieldType.toUpperCase()} click:`, this.fieldName);\n        });\n    }\n\n    /**\n     * Handles keydown events for cursor and deletion tracking\n     * Tracks arrow keys, home/end, and backspace/delete\n     * @param {KeyboardEvent} event - Keyboard event object\n     */\n    handleKeydown(event) {\n        // Track cursor movements\n        const cursorKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Home', 'End', 'PageUp', 'PageDown'];\n        if (cursorKeys.includes(event.key)) {\n            this.trackCursorMovement();\n            this.debug && console.log(`${this.fieldType.toUpperCase()} cursor movement:`, event.key);\n        }\n\n        // Track deletions\n        if (event.key === 'Backspace' || event.key === 'Delete') {\n            this.trackDeletion();\n            this.debug && console.log(`${this.fieldType.toUpperCase()} deletion:`, event.key);\n        }\n    }\n\n    /**\n     * Adds a DOM node to this field's node collection\n     * @param {HTMLElement} node - DOM node to add\n     */\n    addNode(node) {\n        this.nodes.push(node);\n    }\n\n    /**\n     * Resets all tracking counters when form is submitted\n     * Called automatically by Matomo tracker on form submission\n     */\n    resetOnFormSubmit() {\n        this.timespent = 0;\n        this.numFocus = 0;\n        this.numDeletes = 0;\n        this.numCursor = 0;\n        this.numChanges = 0;\n        this.startFocus = null;\n        this.timeLastChange = null;\n        this.canCountChange = true;\n        this.hasChangedValueSinceFocus = false;\n        this.isFocusedCausedAuto = false;\n        this.firstInteractionTime = null;\n        this.cancelDelayedBlur();\n    }\n\n    /**\n     * Calculates total time spent in this field\n     * Includes both tracked time and current session time\n     * @returns {number} Time spent in milliseconds\n     */\n    getTimeSpent() {\n        if (this.numChanges && !this.timespent) {\n            this.timespent = 1;\n        }\n        if (!this.startFocus || this.isFocusedCausedAuto) {\n            return this.timespent;\n        }\n        if (this.timeLastChange) {\n            const timeSpent = this.timeLastChange - this.startFocus;\n            return this.timespent + (timeSpent > 0 ? timeSpent : 0);\n        }\n        return this.timespent + (Date.now() - this.startFocus);\n    }\n\n    /**\n     * Calculates hesitation time before first interaction\n     * Time from field detection to first user interaction\n     * @returns {number} Hesitation time in milliseconds\n     */\n    getHesitationTime() {\n        if (this.numChanges || !this.startFocus || this.isFocusedCausedAuto) {\n            return this.hesitationtime;\n        }\n        return this.hesitationtime + (Date.now() - this.startFocus);\n    }\n\n    /**\n     * Generates tracking parameters for Matomo FormAnalytics\n     * Returns all field metrics in Matomo-compatible format\n     * @returns {Object} Object containing all tracking parameters\n     */\n    getTrackingParams() {\n        return {\n            fa_fn: this.fieldName,\n            fa_ft: this.fieldType,\n            fa_fs: this.getFieldSize(),\n            fa_fb: this.isBlank() ? 1 : 0,\n            fa_fts: this.getTimeSpent(),\n            fa_fht: this.getHesitationTime(),\n            fa_ff: this.numFocus,\n            fa_fch: this.numChanges,\n            fa_fd: this.numDeletes,\n            fa_fcu: this.numCursor\n        };\n    }\n\n    /**\n     * Handles field focus event\n     * Tracks focus count, sets entry field, and triggers Matomo tracking\n     */\n    onFocus() {\n        this.debug && console.log(`‚ö°Ô∏è ${this.fieldType.toUpperCase()} focus (${this.fieldName})`);\n        this.startFocus = Date.now();\n        const isNewField = this.fieldName !== this.tracker.lastFocusedFieldName;\n\n        if (isNewField && !this.isFocusedCausedAuto) {\n            this.numFocus++;\n            this.tracker.setEngagedWithForm();\n            this.tracker.trackFieldUpdate(this);\n            this.tracker.exitFieldName = this.fieldName;\n            this.tracker.scheduleSendUpdate();\n        }\n\n        this.tracker.lastFocusedFieldName = this.fieldName;\n        this.canCountChange = true;\n    }\n\n    /**\n     * Handles field blur event\n     * Calculates time spent and updates tracking data\n     */\n    onBlur() {\n        this.debug && console.log(`‚ö°Ô∏è ${this.fieldType.toUpperCase()} blur (${this.fieldName})`);\n        if (!this.startFocus) return;\n\n        // If firstInteractionTime is set, use it for more accurate time tracking\n        // (useful for click-based fields where onChange happens immediately)\n        if (this.firstInteractionTime && this.hasChangedValueSinceFocus) {\n            const now = Date.now();\n            const totalTime = now - this.firstInteractionTime;\n            this.timespent += totalTime;\n            this.firstInteractionTime = null;\n            this.timeLastChange = null;\n            this.startFocus = null;\n            return;\n        }\n\n        if (this.hasChangedValueSinceFocus) {\n            if (this.timeLastChange && this.startFocus) {\n                this.timespent += (this.timeLastChange - this.startFocus);\n            }\n            this.timeLastChange = null;\n            this.startFocus = null;\n            return;\n        }\n\n        if (!this.isFocusedCausedAuto) {\n            const now = Date.now();\n            this.timespent += now - this.startFocus;\n            if (!this.numChanges) {\n                this.hesitationtime += now - this.startFocus;\n            }\n            this.tracker.setEngagedWithForm();\n            this.tracker.trackFieldUpdate(this);\n        }\n        this.startFocus = null;\n    }\n\n    /**\n     * Handles field change event\n     * Tracks changes, hesitation time, and sets entry field\n     */\n    onChange() {\n        this.debug && console.log(`‚ö°Ô∏è ${this.fieldType.toUpperCase()} changed (${this.fieldName})`);\n        this.timeLastChange = Date.now();\n        if (this.isFocusedCausedAuto) {\n            this.startFocus = this.timeLastChange;\n        } else if (!this.startFocus) {\n            return;\n        }\n\n        this.isFocusedCausedAuto = false;\n        this.hasChangedValueSinceFocus = true;\n\n        if (!this.numChanges) {\n            this.hesitationtime += this.timeLastChange - this.startFocus;\n        }\n\n        if (this.canCountChange) {\n            this.numChanges++;\n            this.canCountChange = false;\n        }\n\n        if (!this.tracker.entryFieldName) {\n            this.tracker.entryFieldName = this.fieldName;\n        }\n\n        this.tracker.setEngagedWithForm();\n        this.tracker.trackFieldUpdate(this);\n    }\n\n    /**\n     * Helper method for tracking cursor movements\n     * Increments cursor count for arrow keys, clicks, etc.\n     */\n    trackCursorMovement() {\n        this.numCursor++;\n    }\n\n    /**\n     * Helper method for tracking deletions\n     * Increments delete count for backspace, delete keys, etc.\n     */\n    trackDeletion() {\n        this.numDeletes++;\n    }\n\n    /**\n     * Destroys the field instance and cleans up all resources\n     * Removes event listeners, clears timers, and nulls heavy references\n     * Safe to call multiple times (idempotent)\n     */\n    destroy() {\n        if (this._isDestroyed) return;\n        this._isDestroyed = true;\n\n        // Remove all tracked event listeners\n        for (const [, listeners] of this._eventListeners) {\n            for (const { element, event, handler, options } of listeners) {\n                try {\n                    element.removeEventListener(event, handler, options);\n                } catch (e) {\n                    this.debug && console.warn(`Failed to remove event listener: ${event}`, e);\n                }\n            }\n        }\n        this._eventListeners.clear();\n\n        // Clear all tracked timers\n        for (const timerId of this._timers) {\n            try {\n                clearTimeout(timerId);\n                clearInterval(timerId);\n            } catch (e) {\n                this.debug && console.warn(`Failed to clear timer: ${timerId}`, e);\n            }\n        }\n        this._timers.clear();\n\n        // Disconnect all tracked MutationObservers\n        for (const observer of this._mutationObservers) {\n            try {\n                observer.disconnect();\n            } catch (e) {\n                this.debug && console.warn(`Failed to disconnect MutationObserver:`, e);\n            }\n        }\n        this._mutationObservers.clear();\n\n        // Null out heavy references to prevent memory leaks\n        this.element = null;\n        this.nodes = null;\n        this.tracker = null;\n        this.startFocus = null;\n        this.timeLastChange = null;\n    }\n}\n"],"names":["fieldClasses","debugMode","createField","tracker","element","fieldName","fieldType","FieldClass","console","error","field","setupEventListeners","injectCustomFields","form","Object","entries","forEach","selector","fields","querySelectorAll","fieldNodes","includes","log","getAttribute","warn","customField","push","reScanFormFields","scanForFields","setupDynamicFieldObserver","reScanTimeout","observer","MutationObserver","mutations","hasNewFields","mutation","addedNodes","node","nodeType","isFormField","matches","querySelector","clearTimeout","setTimeout","observe","childList","subtree","attributes","_fieldObserver","init","customFields","debug","length","window","matomoFormAnalyticsAsyncInit","forms","document","Piwik","FormAnalytics","findFormTrackerInstance","getDebugMode","FieldCategories","TEXT","SELECTABLE","CHECKABLE","isValidFieldCategory","category","values","getSupportedFieldCategories","getFieldCategoryDescription","descriptions","BaseField","constructor","Error","name","discoveredDate","Date","now","timespent","hesitationtime","nodes","tagName","startFocus","timeLastChange","numChanges","numFocus","numDeletes","numCursor","canCountChange","isFocusedCausedAuto","hasChangedValueSinceFocus","firstInteractionTime","_eventListeners","Map","_timers","Set","_mutationObservers","_isDestroyed","_delayedBlurTimer","_addTrackedEventListener","event","handler","options","key","has","set","addEventListener","get","_trackTimer","timerId","add","_trackMutationObserver","trackFirstInteraction","onFocus","scheduleDelayedBlur","delay","cancelDelayedBlur","onBlur","delete","getInteractiveElement","isBlank","getFieldSize","prototype","call","setupDefaultEventListeners","interactiveElement","toUpperCase","onChange","handleKeydown","trackCursorMovement","cursorKeys","trackDeletion","addNode","resetOnFormSubmit","getTimeSpent","timeSpent","getHesitationTime","getTrackingParams","fa_fn","fa_ft","fa_fs","fa_fb","fa_fts","fa_fht","fa_ff","fa_fch","fa_fd","fa_fcu","isNewField","lastFocusedFieldName","setEngagedWithForm","trackFieldUpdate","exitFieldName","scheduleSendUpdate","totalTime","entryFieldName","destroy","listeners","removeEventListener","e","clear","clearInterval","disconnect"],"mappings":"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"}